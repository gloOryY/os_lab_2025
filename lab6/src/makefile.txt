# Компилятор C
CC = gcc

# Флаги компиляции
# -Wall: показывать все предупреждения
# -Wextra: дополнительные предупреждения
# -pthread: поддержка POSIX потоков (обязательно для pthread)
# -O2: оптимизация уровня 2 (опционально, можно удалить для отладки)
CFLAGS = -Wall -Wextra -pthread

# Флаги линковки
# -pthread: подключение библиотеки pthread
LDFLAGS = -pthread

# Имена исполняемых файлов
SERVER = server
CLIENT = client

# Цель по умолчанию (выполняется при простом вызове 'make')
# Собирает и клиент, и сервер
all: $(SERVER) $(CLIENT)

# Правило для сборки сервера
# server: server.c означает, что server зависит от server.c
# Если server.c изменился, server будет пересобран
$(SERVER): server.c
	$(CC) $(CFLAGS) -o $(SERVER) server.c $(LDFLAGS)

# Правило для сборки клиента
$(CLIENT): client.c
	$(CC) $(CFLAGS) -o $(CLIENT) client.c $(LDFLAGS)

# Цель для удаления скомпилированных файлов
# Использование: make clean
clean:
	rm -f $(SERVER) $(CLIENT)

# Цель для пересборки проекта с нуля
# Использование: make rebuild
# Сначала удаляет старые файлы, затем собирает заново
rebuild: clean all

# Указываем, что эти цели не являются файлами
# Это предотвращает конфликты, если в директории есть файлы с такими именами
.PHONY: all clean rebuild
